(this["webpackJsonptime-capsule"]=this["webpackJsonptime-capsule"]||[]).push([[0],{21:function(e,t,s){},26:function(e,t,s){},28:function(e,t,s){"use strict";s.r(t);var c=s(3),a=s.n(c),n=s(15),r=s.n(n),i=(s(21),s(8)),o=s(10),l=s(16),d=s(4),b=(s(26),s(0));const j=Object(l.a)({apiKey:"AIzaSyDoLr3Dnb5YbCnUtTexaz84YOH5h8Ukfoc",authDomain:"frist-b073a.firebaseapp.com",projectId:"frist-b073a",storageBucket:"frist-b073a.appspot.com",messagingSenderId:"580630150830",appId:"1:580630150830:web:815ba6942a64909329b73f",measurementId:"G-GH3D6EMB6L"}),m=Object(d.h)(j),u=Object(o.b)(j);function h(e){let{user:t,onBack:s,groupId:a}=e;const[n,r]=Object(c.useState)(!1),[o,l]=Object(c.useState)(0),[j,u]=Object(c.useState)(0),[h,O]=Object(c.useState)(0),[p,x]=Object(c.useState)([]),[g,N]=Object(c.useState)(!1),[v,f]=Object(c.useState)(!1),[y,w]=Object(c.useState)(!0),[k,C]=Object(c.useState)([]),[S,E]=Object(c.useState)([]),[L,M]=Object(c.useState)(!1),[I,G]=Object(c.useState)("ar"),[P,U]=Object(c.useState)(null),[D,B]=Object(c.useState)([]),[A,T]=Object(c.useState)("timer"),[R,J]=Object(c.useState)(!1),[F,_]=Object(c.useState)([]),[H,Y]=Object(c.useState)([]),[z,K]=Object(c.useState)(null),[W,q]=Object(c.useState)(null),$=e=>{let t=1,s=100,c=100;for(;e>=c;)t++,s=Math.floor(1.15*s),c+=s;const a=e-(c-s);return{currentLevel:t,nextLevelPoints:s,progress:a/s*100,pointsToNextLevel:s-a}},{currentLevel:Q,progress:V,pointsToNextLevel:X}=$(j),Z=(e=>{const t={1:{name:"\u0627\u0644\u0628\u0630\u0631\u0629",icon:"\ud83c\udf31",color:"var(--secondary-color)",bgColor:"rgba(16, 185, 129, 0.1)"},5:{name:"\u0627\u0644\u0645\u062a\u062f\u0631\u0628",icon:"\ud83d\udcd6",color:"var(--primary-color)",bgColor:"rgba(79, 70, 229, 0.1)"},10:{name:"\u0627\u0644\u0645\u062c\u062a\u0647\u062f",icon:"\ud83c\udf93",color:"var(--warning-color)",bgColor:"rgba(245, 158, 11, 0.1)"},20:{name:"\u0627\u0644\u062e\u0628\u064a\u0631",icon:"\ud83d\udd0d",color:"var(--accent-color)",bgColor:"rgba(239, 68, 68, 0.1)"},30:{name:"\u0627\u0644\u0639\u0628\u0642\u0631\u064a",icon:"\ud83e\udde0",color:"var(--primary-dark)",bgColor:"rgba(67, 56, 202, 0.1)"},50:{name:"\u0627\u0644\u0623\u0633\u0637\u0648\u0631\u0629",icon:"\ud83c\udfc6",color:"var(--warning-dark)",bgColor:"rgba(217, 119, 6, 0.1)"},100:{name:"\u0631\u0627\u0626\u062f \u0627\u0644\u0645\u0639\u0631\u0641\u0629",icon:"\ud83d\ude80",color:"var(--secondary-dark)",bgColor:"rgba(5, 150, 105, 0.1)"}};return t[Object.keys(t).map(Number).filter((t=>e>=t)).sort(((e,t)=>t-e))[0]]||t[1]})(Q),ee=e=>{G(e),localStorage.setItem("language",e),te("ar"===e?"\ud83c\uddf8\ud83c\udde6 \u062a\u0645 \u062a\u063a\u064a\u064a\u0631 \u0627\u0644\u0644\u063a\u0629 \u0625\u0644\u0649 \u0627\u0644\u0639\u0631\u0628\u064a\u0629":"\ud83c\uddec\ud83c\udde7 Language changed to English")},te=e=>{U(e),setTimeout((()=>U(null)),3e3)},se=e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),c=e%60;return"".concat(t.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(c.toString().padStart(2,"0"))};Object(c.useEffect)((()=>{const e=async()=>{try{w(!0);const s=await Object(d.f)(Object(d.e)(m,"studyGroups",a));if(s.exists()){var e;const c=s.data();f(c.creator===t.uid),C(c.bannedMembers||[]);const a=(null===(e=c.userPoints)||void 0===e?void 0:e[t.uid])||0;if(u(a),c.members){const e=c.members.map((async e=>{const t=await Object(d.f)(Object(d.e)(m,"users",e));var s;return t.exists()?{uid:e,name:t.data().displayName,photoURL:t.data().photoURL,points:(null===(s=c.userPoints)||void 0===s?void 0:s[e])||0}:null})),t=(await Promise.all(e)).filter(Boolean);t.sort(((e,t)=>t.points-e.points)),x(t)}}}catch(s){console.error("Error fetching group data:",s)}finally{w(!1)}};e();const s=Object(d.i)(Object(d.e)(m,"studyGroups",a),e);return()=>s()}),[a,t.uid]),Object(c.useEffect)((()=>{const e=setInterval((()=>{const e=p.filter((()=>Math.random()>.7)).map((e=>e.uid));E(e)}),1e4);return()=>clearInterval(e)}),[p]),Object(c.useEffect)((()=>{let e;return n&&(e=setInterval((()=>{l((e=>{const t=e+1;return t%30===0&&((e,t)=>{const s={date:new Date,duration:e,pointsEarned:t};B((e=>[s,...e].slice(0,10)))})(t,Math.floor(t/30)),t}))}),1e3)),()=>clearInterval(e)}),[n]),Object(c.useEffect)((()=>{if(n&&o>0&&o%30===0&&o!==h){const e=j+1;u(e),(async e=>{try{var s;const c=await Object(d.f)(Object(d.e)(m,"studyGroups",a));!c.exists()||null!==(s=c.data().bannedMembers)&&void 0!==s&&s.includes(t.uid)||await Object(d.m)(Object(d.e)(m,"studyGroups",a),{["userPoints.".concat(t.uid)]:e})}catch(c){console.error("Error updating points:",c)}})(e),O(o);const s=$(e);s.currentLevel>Q&&te("\ud83c\udf89 \u062a\u0642\u062f\u0645\u062a \u0644\u0644\u0645\u0633\u062a\u0648\u0649 ".concat(s.currentLevel,"!"))}}),[o,n]),Object(c.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("darkMode"));null!==e&&(M(e),document.documentElement.setAttribute("data-theme",e?"dark":"light"));const t=localStorage.getItem("language")||"ar";G(t)}),[]);const ce=async e=>{if(window.confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 ".concat(k.includes(e)?"\u0625\u0644\u063a\u0627\u0621 \u062d\u0638\u0631":"\u062d\u0638\u0631"," \u0647\u0630\u0627 \u0627\u0644\u0639\u0636\u0648\u061f")))try{await Object(d.k)(m,(async s=>{const c=await s.get(Object(d.e)(m,"studyGroups",a));if(!c.exists())throw new Error("\u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629 \u063a\u064a\u0631 \u0645\u0648\u062c\u0648\u062f\u0629");const n=c.data().bannedMembers||[],r=n.includes(e),i={bannedMembers:r?n.filter((t=>t!==e)):[...n,e],banHistory:Object(d.b)({memberId:e,bannedBy:t.uid,timestamp:new Date,action:r?"unban":"ban"})};r||(i["userPoints.".concat(e)]=0),s.update(Object(d.e)(m,"studyGroups",a),i)})),te("\u2705 \u062a\u0645 ".concat(k.includes(e)?"\u0625\u0644\u063a\u0627\u0621 \u062d\u0638\u0631":"\u062d\u0638\u0631"," \u0627\u0644\u0639\u0636\u0648 \u0628\u0646\u062c\u0627\u062d"))}catch(s){console.error("Error updating banned members:",s),te("\u274c \u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u062d\u062f\u064a\u062b \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u062d\u0638\u0631")}},ae=()=>{N((e=>!e))};return Object(b.jsxs)("div",{className:"app-container",children:[Object(b.jsxs)("div",{className:"top-tabs",children:[Object(b.jsx)("button",{className:"menu-toggle",onClick:()=>J(!R),"aria-label":"\u0642\u0627\u0626\u0645\u0629",children:"\u2630"}),Object(b.jsxs)("div",{className:"main-tabs",children:[Object(b.jsxs)("button",{className:"tab-button ".concat("timer"===A?"active":""),onClick:()=>T("timer"),children:[Object(b.jsx)("span",{className:"tab-icon",children:"\u23f1\ufe0f"}),Object(b.jsx)("span",{className:"tab-label",children:"\u0627\u0644\u0645\u0624\u0642\u062a"})]}),Object(b.jsxs)("button",{className:"tab-button ".concat("profile"===A?"active":""),onClick:()=>T("profile"),children:[Object(b.jsx)("span",{className:"tab-icon",children:"\ud83d\udc64"}),Object(b.jsx)("span",{className:"tab-label",children:"\u0627\u0644\u0645\u0644\u0641 \u0627\u0644\u0634\u062e\u0635\u064a"})]}),Object(b.jsxs)("button",{className:"tab-button ".concat("shop"===A?"active":""),onClick:()=>T("shop"),children:[Object(b.jsx)("span",{className:"tab-icon",children:"\ud83d\uded2"}),Object(b.jsx)("span",{className:"tab-label",children:"\u0627\u0644\u0645\u062a\u062c\u0631"})]})]})]}),Object(b.jsxs)("div",{className:"side-menu ".concat(R?"open":""),children:[Object(b.jsx)("button",{className:"close-menu",onClick:()=>J(!1),"aria-label":"\u0625\u063a\u0644\u0627\u0642 \u0627\u0644\u0642\u0627\u0626\u0645\u0629",children:"\u2715"}),Object(b.jsxs)("div",{className:"menu-section",children:[Object(b.jsx)("h3",{children:"\u0645\u062c\u0645\u0648\u0639\u0627\u062a\u0643"}),Object(b.jsx)("button",{onClick:s,className:"back-button",children:"\u2190 \u0627\u0644\u0639\u0648\u062f\u0629 \u0644\u0644\u0645\u062c\u0645\u0648\u0639\u0627\u062a"})]}),Object(b.jsxs)("div",{className:"menu-section",children:[Object(b.jsx)("h3",{children:"\u0625\u0646\u062c\u0627\u0632\u0627\u062a\u0643"}),Object(b.jsxs)("div",{className:"badge-display",style:{backgroundColor:Z.bgColor,borderLeft:"4px solid ".concat(Z.color)},children:[Object(b.jsx)("span",{className:"badge-icon",style:{color:Z.color},children:Z.icon}),Object(b.jsxs)("div",{className:"badge-info",children:[Object(b.jsx)("span",{className:"badge-name",style:{color:Z.color},children:Z.name}),Object(b.jsxs)("span",{className:"badge-level",style:{color:Z.color},children:["\u0627\u0644\u0645\u0633\u062a\u0648\u0649 ",Q]})]})]})]}),Object(b.jsxs)("div",{className:"menu-section",children:[Object(b.jsx)("h3",{children:"\u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a"}),Object(b.jsxs)("div",{className:"settings-option",children:[Object(b.jsx)("span",{children:"\u0627\u0644\u0648\u0636\u0639 \u0627\u0644\u0645\u0638\u0644\u0645:"}),Object(b.jsxs)("label",{className:"switch",children:[Object(b.jsx)("input",{type:"checkbox",checked:L,onChange:()=>{const e=!L;M(e),document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("darkMode",JSON.stringify(e)),te(e?"\ud83c\udf19 \u062a\u0645 \u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0648\u0636\u0639 \u0627\u0644\u0645\u0638\u0644\u0645":"\u2600\ufe0f \u062a\u0645 \u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0648\u0636\u0639 \u0627\u0644\u0641\u0627\u062a\u062d")}}),Object(b.jsx)("span",{className:"slider round"})]})]}),Object(b.jsxs)("div",{className:"settings-option",children:[Object(b.jsx)("span",{children:"\u0627\u0644\u0644\u063a\u0629:"}),Object(b.jsxs)("div",{className:"language-buttons",children:[Object(b.jsx)("button",{className:"language-button ".concat("ar"===I?"active":""),onClick:()=>ee("ar"),children:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629"}),Object(b.jsx)("button",{className:"language-button ".concat("en"===I?"active":""),onClick:()=>ee("en"),children:"English"})]})]})]})]}),Object(b.jsxs)("div",{className:"main-content",children:["timer"===A&&Object(b.jsxs)("div",{className:"timer-container",children:[Object(b.jsxs)("div",{className:"time-display",children:[Object(b.jsx)("h2",{children:"\u0648\u0642\u062a \u0627\u0644\u0645\u0630\u0627\u0643\u0631\u0629"}),Object(b.jsx)("div",{className:"time",children:se(o)})]}),Object(b.jsxs)("div",{className:"stats-display",children:[Object(b.jsxs)("div",{className:"stat-box",children:[Object(b.jsx)("span",{className:"stat-label",children:"\u0627\u0644\u0646\u0642\u0627\u0637"}),Object(b.jsx)("span",{className:"stat-value",children:j})]}),Object(b.jsxs)("div",{className:"stat-box",children:[Object(b.jsx)("span",{className:"stat-label",children:"\u0627\u0644\u0645\u0633\u062a\u0648\u0649"}),Object(b.jsx)("span",{className:"stat-value",children:Q})]})]}),Object(b.jsxs)("div",{className:"progress-container",children:[Object(b.jsxs)("div",{className:"progress-label",children:[Object(b.jsxs)("span",{children:["\u0627\u0644\u062a\u0642\u062f\u0645 \u0644\u0644\u0645\u0633\u062a\u0648\u0649 ",Q+1]}),Object(b.jsxs)("span",{children:[Math.round(V),"%"]})]}),Object(b.jsx)("div",{className:"progress-bar",children:Object(b.jsx)("div",{className:"progress-fill",style:{width:"".concat(V,"%")}})}),Object(b.jsxs)("div",{className:"progress-text",children:[X," \u0646\u0642\u0637\u0629 \u0645\u062a\u0628\u0642\u064a\u0629 \u0644\u0644\u0648\u0635\u0648\u0644 \u0644\u0644\u0645\u0633\u062a\u0648\u0649 \u0627\u0644\u062a\u0627\u0644\u064a"]})]}),Object(b.jsxs)("div",{className:"timer-controls",children:[Object(b.jsx)("button",{onClick:()=>r(!n),className:"control-button ".concat(n?"pause-button":"start-button"),disabled:k.includes(t.uid),children:n?" \u0625\u064a\u0642\u0627\u0641":" \u0628\u062f\u0621"}),Object(b.jsx)("button",{onClick:()=>{r(!1),l(0),te("\u23f1 \u062a\u0645 \u0625\u0639\u0627\u062f\u0629 \u0636\u0628\u0637 \u0627\u0644\u0645\u0624\u0642\u062a")},className:"control-button reset-button",children:"\u0625\u0639\u0627\u062f\u0629 \u062a\u0639\u064a\u064a\u0646"}),Object(b.jsx)("button",{onClick:ae,className:"control-button members-button",children:g?" \u0625\u062e\u0641\u0627\u0621 \u0627\u0644\u0623\u0639\u0636\u0627\u0621":" \u0639\u0631\u0636 \u0627\u0644\u0623\u0639\u0636\u0627\u0621"})]})]}),"profile"===A&&Object(b.jsxs)("div",{className:"profile-container",children:[Object(b.jsxs)("div",{className:"profile-header",children:[Object(b.jsx)("img",{src:t.photoURL,alt:"\u0635\u0648\u0631\u0629 \u0627\u0644\u0645\u0644\u0641 \u0627\u0644\u0634\u062e\u0635\u064a",className:"profile-avatar"}),Object(b.jsx)("h2",{children:t.displayName}),Object(b.jsxs)("p",{className:"user-level",children:["\u0627\u0644\u0645\u0633\u062a\u0648\u0649 ",Q]})]}),Object(b.jsxs)("div",{className:"profile-stats",children:[Object(b.jsxs)("div",{className:"stat-row",children:[Object(b.jsx)("span",{className:"stat-label",children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0646\u0642\u0627\u0637:"}),Object(b.jsx)("span",{className:"stat-value",children:j})]}),Object(b.jsxs)("div",{className:"stat-row",children:[Object(b.jsx)("span",{className:"stat-label",children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0648\u0642\u062a \u0627\u0644\u062f\u0631\u0627\u0633\u0629:"}),Object(b.jsxs)("span",{className:"stat-value",children:[Math.floor(o/3600)," \u0633\u0627\u0639\u0629"]})]}),Object(b.jsxs)("div",{className:"stat-row",children:[Object(b.jsx)("span",{className:"stat-label",children:"\u0627\u0644\u0646\u0642\u0627\u0637 \u0644\u0644\u0648\u0635\u0648\u0644 \u0644\u0644\u0645\u0633\u062a\u0648\u0649 \u0627\u0644\u062a\u0627\u0644\u064a:"}),Object(b.jsx)("span",{className:"stat-value",children:X})]})]}),D.length>0&&Object(b.jsxs)("div",{className:"sessions-history",children:[Object(b.jsx)("h3",{children:"\u0622\u062e\u0631 \u062c\u0644\u0633\u0627\u062a \u0627\u0644\u062f\u0631\u0627\u0633\u0629"}),Object(b.jsx)("div",{className:"sessions-list",children:D.map(((e,t)=>Object(b.jsxs)("div",{className:"session-item",children:[Object(b.jsx)("span",{className:"session-date",children:new Date(e.date).toLocaleDateString()}),Object(b.jsx)("span",{className:"session-duration",children:se(e.duration)}),Object(b.jsxs)("span",{className:"session-points",children:["+",e.pointsEarned," \u0646\u0642\u0637\u0629"]})]},t)))})]})]}),"shop"===A&&Object(b.jsxs)("div",{className:"shop-container",children:[Object(b.jsx)("h2",{children:"\u0645\u062a\u062c\u0631 \u0627\u0644\u0646\u0642\u0627\u0637"}),Object(b.jsxs)("div",{className:"balance-display",children:[Object(b.jsx)("span",{children:"\u0631\u0635\u064a\u062f\u0643 \u0627\u0644\u062d\u0627\u0644\u064a:"}),Object(b.jsxs)("span",{className:"points-balance",children:[j," \u0646\u0642\u0637\u0629"]})]}),Object(b.jsx)("div",{className:"shop-items",children:[{id:"boost",name:"\u062f\u0641\u0639\u0629 \u0627\u0644\u0646\u062c\u0627\u062d",description:"\u064a\u062d\u0642\u0642 \u0636\u0639\u0641 \u0627\u0644\u0646\u0642\u0627\u0637 \u0644\u0645\u062f\u0629 30 \u062f\u0642\u064a\u0642\u0629",price:400,icon:"\u26a1",effect:"double_points",color:"var(--warning-color)",bgColor:"rgba(245, 158, 11, 0.1)",hoverEffect:"glow"},{id:"focus",name:"\u0645\u0639\u0632\u0632 \u0627\u0644\u062a\u0631\u0643\u064a\u0632",description:"\u064a\u0632\u064a\u062f \u0633\u0631\u0639\u0629 \u062a\u062d\u0635\u064a\u0644 \u0627\u0644\u0646\u0642\u0627\u0637 \u0628\u0646\u0633\u0628\u0629 50% \u0644\u0645\u062f\u0629 \u0633\u0627\u0639\u0629",price:300,icon:"\ud83e\udde0",effect:"speed_boost",color:"var(--primary-color)",bgColor:"rgba(79, 70, 229, 0.1)",hoverEffect:"pulse"},{id:"crown",name:"\u0627\u0644\u062a\u0627\u062c \u0627\u0644\u0630\u0647\u0628\u064a",description:"\u064a\u0638\u0647\u0631 \u062a\u0627\u062c \u0630\u0647\u0628\u064a \u0628\u062c\u0627\u0646\u0628 \u0627\u0633\u0645\u0643 \u0641\u064a \u0644\u0648\u062d\u0629 \u0627\u0644\u0645\u062a\u0635\u062f\u0631\u064a\u0646",price:600,icon:"\ud83d\udc51",effect:"golden_crown",color:"var(--warning-dark)",bgColor:"rgba(217, 119, 6, 0.1)",hoverEffect:"float"},{id:"shield",name:"\u062d\u0627\u0641\u0638\u0629 \u0627\u0644\u0646\u0642\u0627\u0637",description:"\u064a\u062d\u0645\u064a \u0646\u0642\u0627\u0637\u0643 \u0645\u0646 \u0627\u0644\u062e\u0633\u0627\u0631\u0629 \u0644\u0645\u062f\u0629 24 \u0633\u0627\u0639\u0629",price:350,icon:"\ud83d\udee1\ufe0f",effect:"points_shield",color:"var(--secondary-color)",bgColor:"rgba(16, 185, 129, 0.1)",hoverEffect:"shake"}].map((e=>Object(b.jsxs)("div",{className:"shop-item ".concat(z===e.id?"hovered":""),style:{borderColor:e.color,backgroundColor:e.bgColor},onMouseEnter:()=>K(e.id),onMouseLeave:()=>K(null),children:[Object(b.jsx)("div",{className:"item-icon",style:{color:e.color},children:e.icon}),Object(b.jsx)("h3",{children:e.name}),Object(b.jsx)("p",{className:"item-description",children:e.description}),Object(b.jsxs)("p",{className:"item-price",style:{color:e.color},children:[e.price," \u0646\u0642\u0637\u0629"]}),Object(b.jsx)("button",{onClick:()=>(async e=>{if(j>=e.price)try{await Object(d.k)(m,(async s=>{const c=await s.get(Object(d.e)(m,"users",t.uid));s.update(Object(d.e)(m,"users",t.uid),{points:c.data().points-e.price,inventory:Object(d.b)(e.id)})})),te("\ud83c\udf89 \u062a\u0645 \u0634\u0631\u0627\u0621 ".concat(e.name,"!")),_([...F,e.id])}catch(s){console.error("Error purchasing item:",s),te("\u26a0\ufe0f \u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0627\u0644\u0634\u0631\u0627\u0621")}else te("\u274c \u0646\u0642\u0627\u0637\u0643 \u063a\u064a\u0631 \u0643\u0627\u0641\u064a\u0629!")})(e),disabled:j<e.price,className:j<e.price?"disabled":"",style:{backgroundColor:e.color},children:j<e.price?"\u0646\u0642\u0627\u0637 \u063a\u064a\u0631 \u0643\u0627\u0641\u064a\u0629":"\u0634\u0631\u0627\u0621"})]},e.id)))})]})]}),Object(b.jsxs)("div",{className:"members-sidebar ".concat(g?"show":""),children:[Object(b.jsxs)("div",{className:"sidebar-header",children:[Object(b.jsx)("h3",{children:"\u062a\u0631\u062a\u064a\u0628 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629"}),Object(b.jsx)("button",{className:"close-sidebar",onClick:ae,children:"\u2715"})]}),y?Object(b.jsxs)("div",{className:"loading-container",children:[Object(b.jsx)("div",{className:"spinner"}),Object(b.jsx)("p",{children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0623\u0639\u0636\u0627\u0621..."})]}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"leaderboard",children:p.filter((e=>!k.includes(e.uid))).map(((e,s)=>Object(b.jsxs)("div",{className:"member-item ".concat(e.uid===t.uid?"current-user":""),onMouseEnter:()=>q(e.uid),onMouseLeave:()=>q(null),children:[Object(b.jsx)("span",{className:"member-rank",children:s+1}),Object(b.jsxs)("div",{className:"avatar-container",children:[Object(b.jsx)("img",{src:e.photoURL,alt:e.name,className:"member-avatar ".concat(W===e.uid?"avatar-hover":"")}),S.includes(e.uid)&&Object(b.jsx)("div",{className:"online-status"}),W===e.uid&&Object(b.jsx)("div",{className:"avatar-tooltip",children:e.name})]}),Object(b.jsxs)("div",{className:"member-info",children:[Object(b.jsx)("span",{className:"member-name",children:e.name}),Object(b.jsxs)("span",{className:"member-points",children:[e.points," \u0646\u0642\u0637\u0629"]})]}),v&&e.uid!==t.uid&&Object(b.jsxs)("div",{className:"member-actions",children:[Object(b.jsx)("button",{onClick:()=>ce(e.uid),className:"ban-button",title:k.includes(e.uid)?"\u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u062d\u0638\u0631":"\u062d\u0638\u0631 \u0627\u0644\u0639\u0636\u0648",children:k.includes(e.uid)?"\ud83d\udeab":"\u26d4"}),Object(b.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0647\u0630\u0627 \u0627\u0644\u0639\u0636\u0648 \u0645\u0646 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629\u061f"))try{await Object(d.k)(m,(async t=>{const s=await t.get(Object(d.e)(m,"studyGroups",a));if(!s.exists())throw new Error("\u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629 \u063a\u064a\u0631 \u0645\u0648\u062c\u0648\u062f\u0629");const c=s.data(),n=c.members.filter((t=>t!==e)),r=Object(i.a)({},c.userPoints);delete r[e],t.update(Object(d.e)(m,"studyGroups",a),{members:n,userPoints:r})})),te("\u2705 \u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0639\u0636\u0648 \u0628\u0646\u062c\u0627\u062d")}catch(t){console.error("Error removing member:",t),te("\u274c \u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062d\u0630\u0641 \u0627\u0644\u0639\u0636\u0648")}})(e.uid),className:"remove-button",title:"\u062d\u0630\u0641 \u0627\u0644\u0639\u0636\u0648",children:"\u2715"})]})]},e.uid)))}),k.length>0&&Object(b.jsxs)("div",{className:"banned-section",children:[Object(b.jsx)("h4",{children:"\u0627\u0644\u0623\u0639\u0636\u0627\u0621 \u0627\u0644\u0645\u062d\u0638\u0648\u0631\u064a\u0646"}),p.filter((e=>k.includes(e.uid))).map((e=>Object(b.jsxs)("div",{className:"member-item banned-member",children:[Object(b.jsx)("div",{className:"avatar-container",children:Object(b.jsx)("img",{src:e.photoURL,alt:e.name,className:"member-avatar"})}),Object(b.jsxs)("div",{className:"member-info",children:[Object(b.jsx)("span",{className:"member-name",children:e.name}),Object(b.jsx)("span",{className:"banned-label",children:"\u0645\u062d\u0638\u0648\u0631"})]}),v&&Object(b.jsx)("button",{onClick:()=>ce(e.uid),className:"unban-button",children:"\u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u062d\u0638\u0631"})]},e.uid)))]})]})]}),P&&Object(b.jsx)("div",{className:"notification",children:P})]})}var O=function(){const[e,t]=Object(c.useState)(null),[s,a]=Object(c.useState)(""),[n,r]=Object(c.useState)([]),[l,j]=Object(c.useState)(!1),[O,p]=Object(c.useState)(null),[x,g]=Object(c.useState)(!1),[N,v]=Object(c.useState)(""),[f,y]=Object(c.useState)(!1),[w,k]=Object(c.useState)(null),C=e=>{k(e),setTimeout((()=>k(null)),3e3)};Object(c.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("darkMode"));null!==e&&(y(e),document.documentElement.setAttribute("data-theme",e?"dark":"light"))}),[]),Object(c.useEffect)((()=>{const e=Object(o.c)(u,(async e=>{e?(await Object(d.l)(Object(d.e)(m,"users",e.uid),{displayName:e.displayName,photoURL:e.photoURL,email:e.email,lastLogin:new Date},{merge:!0}),t(e),await S(e.uid)):(t(null),r([]),p(null))}));return()=>e()}),[]);const S=async e=>{j(!0);try{const t=Object(d.j)(Object(d.c)(m,"studyGroups"),Object(d.n)("members","array-contains",e)),s=await Object(d.g)(t),c=s.docs.map((async t=>{var s;const c=t.data();if(null!==(s=c.bannedMembers)&&void 0!==s&&s.includes(e))return null;const a=await Object(d.f)(Object(d.e)(m,"users",c.creator)),n=a.exists()?a.data().displayName:"\u0645\u0633\u062a\u062e\u062f\u0645 \u063a\u064a\u0631 \u0645\u0639\u0631\u0648\u0641";return Object(i.a)(Object(i.a)({id:t.id},c),{},{creatorName:n,code:t.id.slice(0,6).toUpperCase(),isCreator:c.creator===e})})),a=(await Promise.all(c)).filter(Boolean);r(a),O&&!a.some((e=>e.id===O))&&p(null)}catch(t){console.error("Error fetching user groups:",t),C("\u274c \u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062c\u0644\u0628 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0627\u062a")}finally{j(!1)}},E=async()=>{if(s.trim())try{const t={name:s.trim(),createdAt:new Date,creator:e.uid,members:[e.uid],userPoints:{[e.uid]:0},bannedMembers:[]};await Object(d.a)(Object(d.c)(m,"studyGroups"),t),a(""),C('\ud83c\udf89 \u062a\u0645 \u0625\u0646\u0634\u0627\u0621 \u0645\u062c\u0645\u0648\u0639\u0629 "'.concat(s.trim(),'" \u0628\u0646\u062c\u0627\u062d')),await S(e.uid)}catch(t){console.error("Error adding group:",t),C("\u274c \u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629")}else C("\u26a0\ufe0f \u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629")},L=()=>{p(null)};return O&&e?Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(h,{user:e,onBack:L,groupId:O})}):Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)("button",{onClick:()=>{const e=!f;y(e),document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("darkMode",JSON.stringify(e)),C(e?"\ud83c\udf19 \u062a\u0645 \u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0648\u0636\u0639 \u0627\u0644\u0645\u0638\u0644\u0645":"\u2600\ufe0f \u062a\u0645 \u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0648\u0636\u0639 \u0627\u0644\u0641\u0627\u062a\u062d")},className:"theme-toggle","aria-label":f?"\u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0648\u0636\u0639 \u0627\u0644\u0641\u0627\u062a\u062d":"\u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0648\u0636\u0639 \u0627\u0644\u063a\u0627\u0645\u0642",children:f?"\u2600\ufe0f":"\ud83c\udf19"}),Object(b.jsxs)("header",{className:"App-header",children:[Object(b.jsx)("div",{className:"login-container",children:e?Object(b.jsx)("div",{className:"user-welcome",children:Object(b.jsxs)("div",{className:"user-info",children:[Object(b.jsx)("img",{src:e.photoURL,alt:"\u0635\u0648\u0631\u0629 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645",className:"user-avatar"}),Object(b.jsxs)("div",{className:"user-details",children:[Object(b.jsxs)("h2",{children:["\u0645\u0631\u062d\u0628\u0627\u064b ",e.displayName,"!"]}),Object(b.jsx)("button",{className:"logout-button",onClick:async()=>{try{await Object(o.e)(u),C("\u2705 \u062a\u0645 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062e\u0631\u0648\u062c \u0628\u0646\u062c\u0627\u062d")}catch(e){console.error("Error signing out:",e)}},children:"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062e\u0631\u0648\u062c"})]})]})}):Object(b.jsxs)("div",{className:"welcome-screen",children:[Object(b.jsx)("h1",{children:"\u0645\u062c\u0645\u0648\u0639\u0627\u062a \u0627\u0644\u062f\u0631\u0627\u0633\u0629 \u0627\u0644\u062a\u0639\u0627\u0648\u0646\u064a\u0629"}),Object(b.jsx)("p",{children:"\u0627\u0646\u0636\u0645 \u0625\u0644\u0649 \u0645\u062c\u062a\u0645\u0639 \u0627\u0644\u0645\u0630\u0627\u0643\u0631\u0629 \u0645\u0639 \u0627\u0644\u0623\u0635\u062f\u0642\u0627\u0621 \u0648\u062d\u0642\u0642 \u0623\u0647\u062f\u0627\u0641\u0643 \u0627\u0644\u062a\u0639\u0644\u064a\u0645\u064a\u0629"}),Object(b.jsx)("button",{className:"login-button",onClick:async()=>{const e=new o.a;try{const t=await Object(o.d)(u,e);C("\ud83c\udf89 \u0645\u0631\u062d\u0628\u0627\u064b ".concat(t.user.displayName,"!"))}catch(t){console.error("Error signing in:",t),C("\u274c \u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644")}},children:Object(b.jsx)("span",{children:"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644 \u0628\u0627\u0633\u062a\u062e\u062f\u0627\u0645 Google"})})]})}),e&&Object(b.jsxs)("div",{className:"group-management",children:[Object(b.jsxs)("div",{className:"group-creation",children:[Object(b.jsx)("h2",{children:"\u0625\u0646\u0634\u0627\u0621 \u0645\u062c\u0645\u0648\u0639\u0629 \u062c\u062f\u064a\u062f\u0629"}),Object(b.jsxs)("div",{className:"input-group",children:[Object(b.jsx)("input",{type:"text",value:s,onChange:e=>a(e.target.value),placeholder:"\u0623\u062f\u062e\u0644 \u0627\u0633\u0645 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629",onKeyPress:e=>"Enter"===e.key&&E()}),Object(b.jsx)("button",{className:"create-button",onClick:E,children:"\u0625\u0646\u0634\u0627\u0621"})]})]}),Object(b.jsxs)("div",{className:"join-group",children:[Object(b.jsx)("h2",{children:"\u0627\u0644\u0627\u0646\u0636\u0645\u0627\u0645 \u0625\u0644\u0649 \u0645\u062c\u0645\u0648\u0639\u0629"}),Object(b.jsx)("button",{className:"join-button",onClick:()=>g(!0),children:"\u0627\u0644\u0627\u0646\u0636\u0645\u0627\u0645 \u0628\u0645\u062c\u0645\u0648\u0639\u0629 \u0645\u0648\u062c\u0648\u062f\u0629"})]})]}),e&&Object(b.jsxs)("div",{className:"study-groups",children:[Object(b.jsx)("h2",{children:"\u0645\u062c\u0645\u0648\u0639\u0627\u062a\u0643 \u0627\u0644\u062f\u0631\u0627\u0633\u064a\u0629"}),l?Object(b.jsxs)("div",{className:"loading-container",children:[Object(b.jsx)("div",{className:"spinner"}),Object(b.jsx)("p",{children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0627\u062a..."})]}):0===n.length?Object(b.jsxs)("div",{className:"empty-state",children:[Object(b.jsx)("img",{src:"/empty-groups.svg",alt:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u062c\u0645\u0648\u0639\u0627\u062a",className:"empty-image"}),Object(b.jsx)("p",{children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u062c\u0645\u0648\u0639\u0627\u062a \u0645\u062a\u0627\u062d\u0629 \u062d\u0627\u0644\u064a\u0627\u064b"}),Object(b.jsx)("button",{className:"create-button",onClick:()=>document.querySelector(".group-creation input").focus(),children:"\u0625\u0646\u0634\u0627\u0621 \u0645\u062c\u0645\u0648\u0639\u0629 \u062c\u062f\u064a\u062f\u0629"})]}):Object(b.jsx)("div",{className:"groups-grid",children:n.map((t=>Object(b.jsxs)("div",{id:"group-".concat(t.id),className:"group-card",children:[Object(b.jsxs)("div",{className:"group-content",children:[Object(b.jsx)("h3",{className:"group-name",children:t.name}),Object(b.jsxs)("p",{className:"group-meta",children:[Object(b.jsxs)("span",{className:"group-creator",children:["\u0627\u0644\u0645\u0646\u0634\u0626: ",t.creatorName]}),Object(b.jsxs)("span",{className:"group-code",children:["\u0643\u0648\u062f: ",t.code]})]}),t.isCreator&&Object(b.jsx)("span",{className:"creator-badge",children:"\u0623\u0646\u062a \u0627\u0644\u0645\u0646\u0634\u0626"})]}),Object(b.jsxs)("div",{className:"group-actions",children:[Object(b.jsx)("button",{onClick:()=>{return e=t.id,void p(e);var e},className:"join-button",children:"\u062f\u062e\u0648\u0644 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629"}),t.isCreator&&Object(b.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("\u26a0\ufe0f \u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629\u061f \u0633\u064a\u062a\u0645 \u062d\u0630\u0641 \u062c\u0645\u064a\u0639 \u0628\u064a\u0627\u0646\u0627\u062a\u0647\u0627 \u0646\u0647\u0627\u0626\u064a\u0627\u064b"))try{const s=document.getElementById("group-".concat(t));s&&(s.style.transform="scale(0.9)",s.style.opacity="0.5",s.style.transition="all 0.3s ease",s.style.animation="shake 0.5s",await new Promise((e=>setTimeout(e,500)))),await Object(d.d)(Object(d.e)(m,"studyGroups",t)),C("\u2705 \u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629 \u0628\u0646\u062c\u0627\u062d"),await S(e.uid)}catch(s){console.error("Error deleting group:",s),C("\u274c \u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062d\u0630\u0641 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629")}})(t.id),className:"delete-button",children:"\u062d\u0630\u0641 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629"})]})]},t.id)))})]}),x&&Object(b.jsx)("div",{className:"modal-overlay",onClick:()=>g(!1),children:Object(b.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[Object(b.jsx)("button",{className:"close-button",onClick:()=>g(!1),children:"\xd7"}),Object(b.jsx)("h2",{children:"\u0627\u0644\u0627\u0646\u0636\u0645\u0627\u0645 \u0625\u0644\u0649 \u0645\u062c\u0645\u0648\u0639\u0629"}),Object(b.jsx)("p",{children:"\u0623\u062f\u062e\u0644 \u0643\u0648\u062f \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629 \u0627\u0644\u0645\u0643\u0648\u0646 \u0645\u0646 6 \u0623\u062d\u0631\u0641"}),Object(b.jsx)("input",{type:"text",value:N,onChange:e=>v(e.target.value),placeholder:"\u0623\u062f\u062e\u0644 \u0643\u0648\u062f \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629",maxLength:6,className:"join-input"}),Object(b.jsxs)("div",{className:"modal-actions",children:[Object(b.jsx)("button",{onClick:async()=>{if(N.trim())try{const s=Object(d.c)(m,"studyGroups"),c=await Object(d.g)(s);let a=null;if(c.forEach((e=>{const t=e.id.slice(0,6).toUpperCase();t===N.toUpperCase().trim()&&(a=Object(i.a)(Object(i.a)({id:e.id},e.data()),{},{code:t}))})),a){var t;if(null!==(t=a.bannedMembers)&&void 0!==t&&t.includes(e.uid))return void C("\ud83d\udeab \u0623\u0646\u062a \u0645\u062d\u0638\u0648\u0631 \u0645\u0646 \u0647\u0630\u0647 \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629 (".concat(a.name,")"));if(a.members&&a.members.includes(e.uid))return p(a.id),g(!1),void v("");await Object(d.m)(Object(d.e)(m,"studyGroups",a.id),{["userPoints.".concat(e.uid)]:0,members:[...a.members||[],e.uid]}),p(a.id),g(!1),v(""),C('\u062a\u0645 \u0627\u0644\u0627\u0646\u0636\u0645\u0627\u0645 \u0625\u0644\u0649 \u0645\u062c\u0645\u0648\u0639\u0629 "'.concat(a.name,'"')),await S(e.uid)}else C("\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u062c\u0645\u0648\u0639\u0629 \u0628\u0647\u0630\u0627 \u0627\u0644\u0643\u0648\u062f")}catch(s){console.error("Error joining group:",s),C("\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0627\u0644\u0627\u0646\u0636\u0645\u0627\u0645 \u0644\u0644\u0645\u062c\u0645\u0648\u0639\u0629")}else C("\u26a0\ufe0f \u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062f\u062e\u0627\u0644 \u0643\u0648\u062f \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629")},className:"confirm-button",children:"\u062a\u0623\u0643\u064a\u062f \u0627\u0644\u0627\u0646\u0636\u0645\u0627\u0645"}),Object(b.jsx)("button",{onClick:()=>g(!1),className:"cancel-button",children:"\u0625\u0644\u063a\u0627\u0621"})]})]})}),w&&Object(b.jsx)("div",{className:"notification",children:w}),Object(b.jsx)("footer",{className:"app-footer",children:Object(b.jsxs)("p",{children:["\u062a\u0645 \u062a\u0637\u0648\u064a\u0631\u0647 \u0628\u0648\u0627\u0633\u0637\u0629 \u0645\u062d\u0645\u062f \u0623\u0628\u0648 \u0637\u0628\u064a\u062e \xa9 ",(new Date).getFullYear()]})})]})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var p=e=>{e&&"function"===typeof e&&s.e(3).then(s.bind(null,29)).then((t=>{let{getCLS:s,getFID:c,getFCP:a,getLCP:n,getTTFB:r}=t;s(e),c(e),a(e),n(e),r(e)})).catch((e=>{console.log("Error importing web-vitals:",e)}))};document.title="TimeCapsule",r.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(O,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()})).catch((e=>{console.error(e.message)})),p()}},[[28,1,2]]]);
//# sourceMappingURL=main.20afd314.chunk.js.map